import { Service } from "typedi";

@Service()
export class MalwareSectionUiFactory {

    decorateMalwareSection = (json: any) => {
        this.googleMalwareSection(json)
        this.mCaffeeMalwareSection(json)
        this.nortonMalwareSection(json)
        this.avgMalwareSection(json)
        this.malwareUiSection(json)
    }

    private googleMalwareSection(json: any) {
        if (json.malware.data.google == "safe") {
            json.malware.googleVerified = "mdi-check";
            json.malware.googleColor = "success";
        } else {
            json.malware.googleVerified = "mdi-close";
            json.malware.googleColor = "danger";
        }
    }

    private mCaffeeMalwareSection(json: any) {
        if (json.malware.data.mcafee == "safe") {
            json.malware.mcafeeVerified = "mdi-check"
            json.malware.mcafeeColor = "success"
        } else if (json.malware.data.mcafee == "unverified") {
            json.malware.mcafeeVerified = "mdi-close"
            json.malware.mcafeeColor = "danger"
        }
    }

    private nortonMalwareSection(json: any) {
        if (json.malware.data.norton == "safe") {
            json.malware.nortonVerified = "mdi-check";
            json.malware.nortonColor = "success";
        } else if (json.malware.data.norton == "unverified") {
            json.malware.nortonVerified = "mdi-close";
            json.malware.nortonColor = "danger";
        }
    }

    private avgMalwareSection(json: any) {
        if (json.malware.data.avg == "safe") {
            json.malware.avgVerified = "mdi-check";
            json.malware.avgColor = "success";
        } else if (json.malware.data.avg == "unverified") {
            json.malware.avgVerified = "mdi-close";
            json.malware.avgColor = "danger";
        }
    }

    private malwareUiSection(json: any) {
        if (
            json.malware.data.avg == "unverified" ||
            json.malware.data.norton == "unverified" ||
            json.malware.data.mcafee == "unverified" ||
            json.malware.data.google == "unverified"
        ) {
            json.malware.color = "panel-danger";
            json.malware.warning = "Warning";
            json.malware.shortAnswer =
                "Your website has NOT been flagged as safe by popular malware scanners.";
        } else {
            json.malware.color = "panel-success";
            json.malware.warning = "Good";
            json.malware.shortAnswer =
                "Your website has been flagged as safe by popular malware scanners";
        }
    }

}