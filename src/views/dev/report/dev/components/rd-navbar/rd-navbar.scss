@import "../bootstrap/scss/functions";
@import "../base/functions";
@import "../base/variables";
@import "../bootstrap/scss/variables";
@import "../bootstrap/scss/mixins";
@import "../theme-switcher/functions";
@import "../theme-switcher/mixins";


// Variables
$navbar-panel-color: $gray-900;
$navbar-panel-bg: $body-bg;
$navbar-panel-inner-bg: $white;

$navbar-sidebar-color: $white;
$navbar-sidebar-bg: $primary;

$navbar-toggle-color: $primary;
$navbar-toggle-hover-color: $gray-900;

$navbar-search-color: $gray-700;
$navbar-logo-invert: 0%;


// Css variables for color themes
@include cssv-init( 'navbar-sidebar-color', $navbar-sidebar-color );
@include cssv-init( 'navbar-sidebar-bg', $navbar-sidebar-bg );
@include cssv-init( 'navbar-toggle-color', $navbar-toggle-color );
@include cssv-init( 'navbar-logo-invert', $navbar-logo-invert );


// Base
.rd-navbar {
	position: relative;
	z-index: $zindex-fixed;

	li {
		list-style: none;
	}
}


// Toggles
.navbar-toggle {
	position: relative;
	display: block;
	border: none;
	font-size: 30px;
	width: 30px;
	height: 30px;
	line-height: 1;
	opacity: 1;
	visibility: visible;
	background: transparent;
	color: cssv( navbar-toggle-color );
	transition: .25s ease-in-out;

	&::before,
	&::after {
		position: absolute;
		top: 50%;
		left: 50%;
		transition: .25s, color 0s;
	}

	&::before {
		transform: translate( -50%, -50% ) rotate(0) scale(1);
		opacity: 1;
	}

	&::after {
		content: '\f24c';
		transform: translate( -50%, -50% ) rotate(90deg)  scale(0);
		font-family: 'Material Design Icons';
		opacity: 0;
	}

	&:hover {
		color: $navbar-toggle-hover-color;
	}

	&.active {
		&::before {
			transform: translate( -50%, -50% ) rotate(-90deg)  scale(0);
			opacity: 0;
		}

		&::after {
			transform: translate( -50%, -50% ) rotate(0deg)  scale(1);
			opacity: 1;
		}
	}
}

.navbar-toggle-sidebar {
	position: absolute;
	top: 50%;
	right: 10px;
	transform: translateY(-50%);
	display: flex;
	align-items: center;
	justify-content: center;
	width: 33px;
	height: 33px;
	font-size: 33px;
	line-height: 1;
	border: none;
	background: none;
	color: cssv( navbar-sidebar-color );
	transition: .2s ease-in-out;

	&:hover {
		background: cssv-rgba( navbar-sidebar-color, .2 );
	}
}

.navbar-toggle-search {
	position: relative;
	z-index: 1;
}

.navbar-toggle-search-cell {
	display: none;
}


// Toggle badge
.navbar-badge {
	position: absolute;
	bottom: 43%;
	left: 54%;
	display: flex;
	align-items: center;
	justify-content: center;
	width: 15px;
	height: 15px;
	min-width: 0;
	padding: 2px;
	font-size: 12px;
	font-weight: 600;
	line-height: 1;
	opacity: 1;
	visibility: visible;
	transition: .2s ease-in-out;
}


// Top panel
.rd-navbar-panel {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	display: flex;
	align-items: stretch;
	padding: 5px 5px 5px 50px;
	min-height: 50px;
	background: cssv( navbar-sidebar-bg );
	color: $navbar-panel-color;
	transition: padding-left .25s ease-in-out;
}

.rd-navbar-panel-inner {
	position: relative;
	flex-grow: 1;
	display: flex;
	align-items: center;
	border-radius: 8px;
	background: $navbar-panel-inner-bg;
}

.rd-navbar-panel-cell {
	position: relative;
	padding: 0 4px;
	opacity: 1;
	visibility: visible;
	transition: .25s ease-in-out;
}

.rd-navbar-panel-spacer {
	display: flex;
	align-items: stretch;
	flex-grow: 1;
	align-self: stretch;
}


// Subpanel (opened by navbar toggle)
.rd-navbar-subpanel {
	position: fixed;
	top: 50px;
	right: 0;
	left: 0;
	transform: translateY( 20px ) scale( .9 );
	display: flex;
	max-height: calc( 100vh - 50px );
	visibility: hidden;
	opacity: 0;
	transition: .2s ease-in-out;
	box-shadow: $box-shadow-sm;
	color: $body-color;

	&.active {
		transform: translateY( 0 ) scale( 1 );
		visibility: visible;
		opacity: 1;
	}

	> * {
		flex-grow: 1;
	}
}


// Sidebar
.rd-navbar-sidebar {
	position: fixed;
	top: 50px;
	bottom: 0;
	left: 0;
	width: 250px;
	padding-bottom: 80px;
	font-size: 17px;
	overflow: hidden;
	background: cssv( navbar-sidebar-bg );
	color: cssv( navbar-sidebar-color );
	transition: transform .25s ease-in-out, padding .25s ease-in-out;
}


// Separate top panel for the sidebar
.rd-navbar-sidebar-panel {
	position: fixed;
	top: 0;
	left: 0;
	z-index: $zindex-fixed;
	display: flex;
	align-items: center;
	justify-content: center;
	width: 250px;
	min-height: 50px;
	padding: 4px 50px 4px 10px;
	background: cssv( navbar-sidebar-bg );
	color: cssv( navbar-sidebar-color );
	transition: transform .25s ease-in-out;
}


// Navbar logo
.rd-navbar-logo {
	filter: unquote( 'invert( #{cssv( navbar-logo-invert )} )' );
}

.logo-link {
	display: block;
}

.logo-default,
.logo-compact {
	margin: 0;
}

.logo-default {
	display: none;
	margin-top: -17%;
}


// Search panel
.navbar-search {
	flex-grow: 1;
	display: flex;
	align-items: center;
	padding: 0 9px;
	color: $navbar-search-color;
}

.navbar-search-input {
	flex-grow: 1;
	width: 100%;
	height: 100%;
	border: none;
	font-weight: 400;
	font-size: 17px;
	background: none;
	color: inherit;

	&::placeholder {
		color: inherit;
	}
}


// Main navigation styles
.rd-navbar-nav,
.rd-navbar-dropdown {
	padding: 0;
}

.rd-navbar-nav {
	padding-right: 5px;
}

.rd-navbar-dropdown {
	display: none;
	font-size: 15px;

	.rd-navbar-link {
		padding-left: 25px;
	}

	.rd-navbar-dropdown .rd-navbar-link {
		padding-left: 40px;
	}
}

.rd-navbar-title {
	display: flex;
	align-items: center;
	padding: 10px;
	border-bottom: 1px solid cssv-rgba( navbar-sidebar-color, .1 );
	font-weight: 700;
	text-transform: uppercase;
	background-clip: border-box;
	color: cssv( navbar-sidebar-color );
}

.rd-navbar-link {
	display: flex;
	align-items: center;
	padding: 10px 44px 10px 10px;
	border-radius: 0 22px 22px 0;
	transition: .15s;
	background-clip: padding-box;
	color: inherit;

	&:hover {
		cursor: pointer;
		background: cssv-rgba( navbar-sidebar-color, .15 );
		color: inherit;
	}
}

.rd-navbar-dropdown-item.active,
.rd-navbar-nav-item.active {
	> .rd-navbar-link {
		background: cssv-rgba( navbar-sidebar-color, .15 );
		color: inherit;
	}
}

* + .rd-navbar-nav-item {
	margin-top: 5px;
}

.rd-navbar-icon {
	flex-shrink: 0;
	padding-right: 10px;
	line-height: 1;
	font-size: 23px;
}

.rd-navbar-title-icon {
	width: 0;
	padding: 0;
	opacity: 0;
	visibility: hidden;
}

.rd-navbar-text {
	white-space: nowrap;
	text-overflow: ellipsis;
	overflow: hidden;
}

.rd-navbar-submenu-toggle {
	position: absolute;
	top: 0;
	right: 0;
	transform: rotate( 0deg );
	display: flex;
	align-items: center;
	justify-content: center;
	width: 44px;
	height: 44px;
	padding: 5px;
	border-radius: 50%;
	font-size: 18px;
	transition: background .15s;

	&::before {
		content: '\f105';
		position: relative;
		font-family: 'FontAwesome';
		transition: transform .2s ease-in-out;
	}

	&:hover {
		background: cssv-rgba( navbar-sidebar-color, .15 );
		cursor: pointer;
	}
}

.rd-navbar-submenu {
	position: relative; 

	&.opened {
		> .rd-navbar-submenu-toggle::before {
			transform: rotate( 90deg );
		}

		> .rd-navbar-dropdown {
			display: block;
		}
	}
}


// Navbar user
.navbar-user {
	height: auto;
	border-radius: 50%;
	overflow: hidden;

	&::before,
	&::after {
		content: none;
	}

	&:hover {
		cursor: pointer;
	}

	img {
		display: block;
	}
}


// Panel active state (when the search panel is opened)
.rd-navbar-panel.active {
	.navbar-search {
		opacity: 1;
		visibility: visible;
		transform: scaleX( 1 );
	}
}


// Media
@include media-breakpoint-down( xs ) {
	.navbar-toggle-search-cell {
		display: block;
	}

	.navbar-search {
		position: fixed;
		top: 5px;
		left: 50px;
		right: 5px;
		height: 40px;
		padding: 0 30px 0 10px;
		opacity: 0;
		visibility: hidden;
		transform: scaleX( .8 );
		transform-origin: 0 50%;
		transition: .25s ease-in-out;
	}

	.rd-navbar-panel.active {
		.navbar-toggle:not(.navbar-toggle-search) {
			width: 0;
			opacity: 0;
			visibility: hidden;
		}

		.navbar-badge {
			opacity: 0;
			visibility: hidden;
		}

		.rd-navbar-panel-cell {
			padding-left: 0;
			padding-right: 0;
		}
	}
}

@include media-breakpoint-up( sm ) {
	.navbar-search {
		&::before {
			content: '\f43b';
			font-family: 'Material Design Icons';
			font-size: 30px;
			line-height: 1;
		}
	}

	.navbar-search-input {
		margin-left: 10px;
	}

	.rd-navbar-subpanel {
		position: absolute;
		top: calc(100% + 10px);
		right: 0;
		left: auto;
		width: 300px;
	}
}

@include media-breakpoint-down( lg ) {
	.rd-navbar-sidebar {
		transform: translateX( -110% );
	}

	.rd-navbar-sidebar-panel {
		transform: translateX( -200px );
	}

	// Sidebar active state (when the sidebar is opened)
	.rd-navbar-sidebar-active {
		.rd-navbar-sidebar-panel,
		.rd-navbar-sidebar {
			transform: translateX( 0 );
		}
	}
}

@include media-breakpoint-up( xl ) {
	.navbar-toggle {
		color: $navbar-toggle-color;
	}

	.rd-navbar-panel {
		padding-left: 65px;
		padding-right: 15px;
		will-change: transform;
		background: $navbar-panel-bg;
	}

	.rd-navbar-sidebar-panel {
		transform: translateX(-200px);
	}

	.rd-navbar-icon {
		min-width: 0;
		text-align: center;
	}

	.rd-navbar-sidebar,
	.rd-navbar-text,
	.rd-navbar-icon,
	.rd-navbar-title,
	.rd-navbar-link,
	.rd-navbar-submenu-toggle {
		transition: .25s ease-in-out, color .15s, background .15s;
	}

	.rd-navbar-icon,
	.rd-navbar-text {
		transition: .25s ease-in-out, color 0s, background 0s;
	}

	html:not(.rd-navbar-sidebar-active) .rd-navbar-sidebar-wrap:not(:hover) {
		.rd-navbar-sidebar {
			width: 50px;
		}

		.rd-navbar-text {
			opacity: 0;
			visibility: hidden;
		}

		.rd-navbar-title,
		.rd-navbar-link {
			padding-left: 0;
			padding-right: 0;
		}

		.rd-navbar-icon {
			padding-left: 0;
			padding-right: 0;
			min-width: 50px;
		}

		.rd-navbar-title-icon {
			opacity: 1;
			visibility: visible;
		}

		.rd-navbar-submenu-toggle {
			opacity: 0;
			visibility: hidden;
		}

		.rd-navbar-dropdown {
			display: none;
		}
	}

	.rd-navbar-sidebar-active,
	html:not(.rd-navbar-sidebar-active) .rd-navbar-sidebar-wrap:hover {
		.rd-navbar-sidebar-panel {
			transform: translateX(0);
		}
	}

	.rd-navbar-sidebar-active {
		.rd-navbar-panel {
			padding-left: 265px;
		}
	}
}

@include media-breakpoint-up( xxl ) {
	.navbar-toggle-sidebar {
		right: 8px;
	}

	.rd-navbar-panel,
	.rd-navbar-sidebar-panel {
		min-height: 110px;
	}

	.rd-navbar-panel {
		padding-left: 103px;
		padding-top: 16px;
		padding-bottom: 15px;
	}

	.rd-navbar-panel-cell {
		padding: 0 13px;
	}

	.rd-navbar-sidebar,
	.rd-navbar-sidebar-panel {
		width: 268px;
	}

	.rd-navbar-sidebar-panel {
		transform: translateX( -180px );
		padding: 4px 63px 4px 27px;
	}

	.rd-navbar-sidebar {
		top: 110px;
	}

	.logo-default {
		display: block;
	}

	.logo-compact {
		display: none;
	}

	.navbar-search-input {
		margin-left: 15px;
	}

	.rd-navbar-nav {
		padding-right: 15px;
	}

	.rd-navbar-title,
	.rd-navbar-link {
		padding-left: 27px;
	}

	.rd-navbar-dropdown {
		.rd-navbar-link {
			padding-left: 40px;
		}

		.rd-navbar-dropdown .rd-navbar-link {
			padding-left: 60px;
		}
	}

	.navbar-user {
		width: 60px;
	}

	html:not(.rd-navbar-sidebar-active) .rd-navbar-sidebar-wrap:not(:hover) {
		.navbar-toggle-sidebar {
			right: 27px;
		}

		.rd-navbar-sidebar {
			width: 88px;
		}

		.rd-navbar-sidebar-panel {
			padding-right: 88px;
			padding-left: 2px;
		}

		.rd-navbar-title,
		.rd-navbar-link {
			padding-left: 19px;
		}
	}

	.rd-navbar-sidebar-active,
	html:not(.rd-navbar-sidebar-active) .rd-navbar-sidebar-wrap:hover {
		.navbar-toggle-sidebar {
			right: 23px;
		}
	}

	.rd-navbar-sidebar-active {
		.rd-navbar-panel {
			padding-left: 283px;
		}
	}
}
